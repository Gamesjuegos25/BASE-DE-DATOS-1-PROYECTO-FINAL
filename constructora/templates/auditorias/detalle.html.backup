{% extends "base.html" %}

{% block content %}
<div class="dashboard-header">
  <h1><i class="fas fa-clipboard-list"></i> Auditoría #{{ auditoria.id_auditoria or auditoria.id }}</h1>
  <a href="{{ url_for('listar_auditorias') }}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Volver</a>
</div>

<div class="card">
  <div class="card-header">
    <h3>
      <span class="badge 
        {% if 'LOGIN' in auditoria.accion_auditoria or 'CREAR' in auditoria.accion_auditoria %}badge-success
        {% elif 'ELIMINAR' in auditoria.accion_auditoria or 'DELETE' in auditoria.accion_auditoria %}badge-danger
        {% elif 'ACTUALIZAR' in auditoria.accion_auditoria or 'UPDATE' in auditoria.accion_auditoria %}badge-warning
        {% else %}badge-info{% endif %}">
        {{ auditoria.accion_auditoria }}
      </span>
    </h3>
  </div>
  
  <div class="card-body">
    <div class="detail-grid">
      <div class="detail-item">
        <strong><i class="fas fa-calendar"></i> Fecha y hora:</strong>
        <p>{{ auditoria.fecha_auditoria }}</p>
      </div>
      
      <div class="detail-item">
        <strong><i class="fas fa-user"></i> Usuario:</strong>
        <p>
          {% if auditoria.nombre_usuario %}
            {{ auditoria.nombre_usuario }}
            {% if auditoria.email_usuario %}
              <br><small class="text-muted">{{ auditoria.email_usuario }}</small>
            {% endif %}
          {% else %}
            <span class="text-muted">Sistema automático</span>
          {% endif %}
        </p>
      </div>
      
      <div class="detail-item">
        <strong><i class="fas fa-hashtag"></i> ID Auditoría:</strong>
        <p>{{ auditoria.id_auditoria or auditoria.id }}</p>
      </div>
      
      {% if auditoria.id_usuario %}
      <div class="detail-item">
        <strong><i class="fas fa-id-badge"></i> ID Usuario:</strong>
        <p>{{ auditoria.id_usuario }}</p>
      </div>
      {% endif %}
    </div>
    
    {% if auditoria.detalle_auditoria %}
    <div class="detail-section">
      <strong><i class="fas fa-info-circle"></i> Detalles adicionales:</strong>
      <div class="detail-box">
        {{ auditoria.detalle_auditoria }}
      </div>
    </div>
    {% endif %}
  </div>
</div>

<div class="info-card">
  <p><i class="fas fa-shield-alt"></i> <strong>Información:</strong> Los registros de auditoría son de solo lectura y se mantienen para garantizar la trazabilidad y seguridad del sistema.</p>
</div>

<style>
.card-header {
  background: #f8f9fa;
  padding: 15px 20px;
  border-bottom: 2px solid #dee2e6;
}
.card-header h3 {
  margin: 0;
}
.detail-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 20px;
}
.detail-item {
  padding: 15px;
  background: #f8f9fa;
  border-radius: 4px;
  border-left: 3px solid #007bff;
}
.detail-item strong {
  color: #495057;
  display: block;
  margin-bottom: 8px;
}
.detail-item p {
  margin: 0;
  color: #212529;
}
.detail-section {
  margin-top: 25px;
  padding-top: 20px;
  border-top: 1px solid #dee2e6;
}
.detail-section strong {
  display: block;
  margin-bottom: 10px;
  color: #495057;
}
.detail-box {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 4px;
  border: 1px solid #dee2e6;
  white-space: pre-wrap;
  word-wrap: break-word;
  font-family: monospace;
  font-size: 14px;
}
.info-card {
  background: #e8f4fd;
  border-left: 4px solid #0056b3;
  padding: 15px;
  margin-top: 20px;
  border-radius: 4px;
}
.info-card i {
  color: #0056b3;
  margin-right: 8px;
}
</style>
{% endblock %}
